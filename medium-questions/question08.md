### Question 8
#### Customer Revenue In March

- Company: Meta/Facebook, Amazon
- Dificulty: Easy

Calculate the total revenue from each customer in March 2019. Include only customers who were active in March 2019.
Output the revenue along with the customer id and sort the results based on the revenue in descending order.

Expected Output:

<table class="ResultsTable__table"><thead><tr class="ResultsTable__header-row"><th class="ResultsTable__header-cell">cust_id</th><th class="ResultsTable__header-cell">revenue</th></tr></thead><tbody><tr class="ResultsTable__row "><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">210</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">150</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">20</td></tr></tbody></table>

Table: orders

<table class="ResultsTable__table"><thead><tr class="ResultsTable__header-row"><th class="ResultsTable__header-cell">id</th><th class="ResultsTable__header-cell">cust_id</th><th class="ResultsTable__header-cell">order_date</th><th class="ResultsTable__header-cell">order_details</th><th class="ResultsTable__header-cell">total_order_cost</th></tr></thead><tbody><tr class="ResultsTable__row "><td class="ResultsTable__cell">1</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-03-04</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">100</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">2</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-03-01</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-03-07</td><td class="ResultsTable__cell">Skirt</td><td class="ResultsTable__cell">30</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">4</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">25</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">5</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-03-10</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">6</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Boats</td><td class="ResultsTable__cell">100</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">60</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">8</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-03-11</td><td class="ResultsTable__cell">Slipper</td><td class="ResultsTable__cell">20</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">9</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-03-01</td><td class="ResultsTable__cell">Jeans</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">10</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-03-09</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">11</td><td class="ResultsTable__cell">5</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">60</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">13</td><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">2019-03-11</td><td class="ResultsTable__cell">Slipper</td><td class="ResultsTable__cell">20</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">14</td><td class="ResultsTable__cell">4</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">4</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">60</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">16</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">17</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Suit</td><td class="ResultsTable__cell">150</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">18</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Skirt</td><td class="ResultsTable__cell">30</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">19</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-04-20</td><td class="ResultsTable__cell">Dresses</td><td class="ResultsTable__cell">200</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">20</td><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">125</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">21</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-01</td><td class="ResultsTable__cell">Suit</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">22</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-02</td><td class="ResultsTable__cell">Skirt</td><td class="ResultsTable__cell">30</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">23</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-03</td><td class="ResultsTable__cell">Dresses</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">24</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-04</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">25</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">25</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">125</td></tr></tbody></table>

<hr>

Answer 01:

```
-- |revenue|customer id|
-- ORDER BY revenue DESC
-- WHERE ORDER DATE = 2019-03

SELECT

cust_id,
SUM (total_order_cost) AS revenue

FROM orders
WHERE to_char (order_date, 'YYYY-MM') = '2019-03'

GROUP BY cust_id
ORDER BY 2 DESC

```
